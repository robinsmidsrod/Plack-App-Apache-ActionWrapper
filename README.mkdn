# NAME

Plack::App::Apache::ActionWrapper - Wrapper for Apache2 Action directive for running PSGI apps on shared hosting with FastCGI

# VERSION

version 0.30.0

# SYNOPSIS

    ------------- .htaccess -----------------
    AddHandler fcgi-script .fcgi
    Action psgi-script /cgi-bin/psgi.fcgi
    AddHandler psgi-script .psgi

    DirectoryIndex index.psgi

    RewriteEngine On
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^(.*)$ index.psgi/$1 [QSA,L]

    ------------- psgi.fcgi -----------------
    #!/usr/bin/env perl

    use strict;
    use warnings;

    # Change this line if you use local::lib or need
    # specific libraries loaded for your application
    use lib '/home/robin/perl5/lib/perl5';

    use Plack::App::Apache::ActionWrapper;
    my $app = Plack::App::Apache::ActionWrapper->new->enable_debug->to_app;

    # Run the actual app
    use Plack::Handler::FCGI;
    Plack::Handler::FCGI->new->run($app);

    1;

    ------------- index.psgi -----------------
    #!/usr/bin/env plackup

    use strict;
    use warnings;

    my $app = sub {
        my $env = shift;
        return [
            200,
            [ 'Content-Type' => 'text/plain' ],
            [
                "This is the index.\n",
                'PATH_INFO=' . $env->{'PATH_INFO'} . "\n",
                'PATH_TRANSLATED=' . $env->{'PATH_TRANSLATED'} . "\n",
            ],
        ];
    };

# DESCRIPTION

The PSGI web application specification is awesome. Plack is awesome as well.
Running PSGI apps using plackup in development is super easy.

But what do you do when you want to deploy your PSGI app on shared hosting?
You can deploy it using traditional CGI, but if you're dealing with
something like Moose or Catalyst-based apps it's bound to be slow.

So your shared hosting provider has provided you with FastCGI support to
mitigate that problem. But because FastCGIExternalServer cannot be defined
in .htaccess you can only run dynamic FastCGI applications.

Your immediate reaction is to define `AddHandler fcgi-script .psgi` in your
.htaccess and use plackup on the shebang line to run your PSGI app. But that
doesn't work if you use local::lib, because @INC is not setup properly.

By using a wrapper as specified in the synopsis you can avoid having to type
in `use lib 'XXX'` in every one of your .psgi files. Another benefit is
that you can preload modules to benefit from copy-on-write on operating
systems that provide it to diminish the memory usage.

# METHODS

## call

The main handler that will be returned by the `to_app` method inherited from [Plack::Component](http://search.cpan.org/perldoc?Plack::Component).

## enable_debug

Mutator to enable debug output if no path was found in PATH_TRANSLATED. Allows chaining.

## disable_debug

Mutator to disable debug output if no path was found in PATH_TRANSLATED. Allows chaining.

## is_debug_enabled

Accessor to determine if debug is enabled or not. Debug is disabled by default.

# SUPPORT

You can find documentation for this module with the perldoc command.

  perldoc Plack::App::Apache::ActionWrapper

## Websites

- Search CPAN

[http://search.cpan.org/dist/Plack-App-Apache-ActionWrapper](http://search.cpan.org/dist/Plack-App-Apache-ActionWrapper)

- AnnoCPAN: Annotated CPAN documentation

[http://annocpan.org/dist/Plack-App-Apache-ActionWrapper](http://annocpan.org/dist/Plack-App-Apache-ActionWrapper)

- CPAN Ratings

[http://cpanratings.perl.org/d/Plack-App-Apache-ActionWrapper](http://cpanratings.perl.org/d/Plack-App-Apache-ActionWrapper)

- CPAN Forum

[http://cpanforum.com/dist/Plack-App-Apache-ActionWrapper](http://cpanforum.com/dist/Plack-App-Apache-ActionWrapper)

- RT: CPAN's Bug Tracker

[http://rt.cpan.org/NoAuth/Bugs.html?Dist=Plack-App-Apache-ActionWrapper](http://rt.cpan.org/NoAuth/Bugs.html?Dist=Plack-App-Apache-ActionWrapper)

- CPANTS Kwalitee

[http://cpants.perl.org/dist/overview/Plack-App-Apache-ActionWrapper](http://cpants.perl.org/dist/overview/Plack-App-Apache-ActionWrapper)

- CPAN Testers Results

[http://cpantesters.org/distro/P/Plack-App-Apache-ActionWrapper.html](http://cpantesters.org/distro/P/Plack-App-Apache-ActionWrapper.html)

- CPAN Testers Matrix

[http://matrix.cpantesters.org/?dist=Plack-App-Apache-ActionWrapper](http://matrix.cpantesters.org/?dist=Plack-App-Apache-ActionWrapper)

- Source Code Repository

The code is open to the world, and available for you to hack on. Please feel free to browse it and play
with it, or whatever. If you want to contribute patches, please send me a diff or prod me to pull
from your repository :)

L<git://github.com/robinsmidsrod/Plack-App-Apache-ActionWrapper.git>

## Bugs

Please report any bugs or feature requests to `bug-plack-app-apache-actionwrapper at rt.cpan.org`, or through
the web interface at [http://rt.cpan.org/NoAuth/ReportBug.html?Queue=Plack-App-Apache-ActionWrapper](http://rt.cpan.org/NoAuth/ReportBug.html?Queue=Plack-App-Apache-ActionWrapper).  I will be
notified, and then you'll automatically be notified of progress on your bug as I make changes.

# AUTHOR

Robin Smidsrød <robin@smidsrod.no>

# COPYRIGHT AND LICENSE

This software is copyright (c) 2011 by Robin Smidsrød.

This is free software; you can redistribute it and/or modify it under
the same terms as the Perl 5 programming language system itself.